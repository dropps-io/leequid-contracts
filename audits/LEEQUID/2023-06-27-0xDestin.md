## **High-Level Overview:**

The following is an audit of the LEEQUID fork of StakeWise V2 according to the [provided scope](https://github.com/dropps-io/leequid-contracts/blob/0f4541e754dfb5c9f86016b1b474664b9e5c2dda/audit_scoping.md). The primary focus was on staking, activating, and registering validators, along with the rewards system. The audit was performed manually, prioritizing smart contract security, which involved a meticulous review of the codebase and the application of static analysis tools such as Slither. Additionally, it's recommended to conduct fuzz testing with Echidna. The time spent on the audit was approximately 40 hours with a similar amount of time spent on learning the codebase and understanding the project, and getting a better grasp of how an audit is conducted. The audit was conducted by [Destin](https://github.com/DestinTech).

## **Identified Issues:**

### **Critical:**

No critical issues were found.

### **High:**

No high-severity issues were found.

### **Medium:**

1. **Potential Dilution Attack Vector (Medium Severity):**
   The staking contract allows sending amounts under `minActivatingDeposit`, bypassing the checks in place to prevent staking if the ratio of the active staked validator is out of acceptable range. This could potentially allow for reward dilution and supply dilution as it takes time to activate a validator node. It is recommended to implement a fee to add a cost barrier to prevent frequent repetitive calls or a conditional check if stakesLyxToken is exceeding the current limit.

2. **Incorrect Oracle Counting (Medium-High Severity):**
   The functions **`addOracle`** and **`removeOracle`** increment and decrement the **`oracleCount`** without checking if the oracle already exists or if it's currently active. This could potentially disrupt decision-making processes or lead to approvals without a true consensus.

### **Low:**

1. **Potential Reentrancy in submitRewards (Low Severity):**
   The function **`submitRewards`** could be further optimized to strictly adhere to the Checks-Effects-Interactions pattern. This helps to ensure the robustness and security of the contract, reducing the risk of potential attacks and inefficiencies.

## **Recommendations:**

1. **Fuzz Testing:** It is advisable to conduct further fuzz testing to discover potential edge cases that could result in unanticipated behavior.
2. **Bug Bounty Program:** Establishing a bug bounty program can incentivize the discovery of possible security issues, thereby aiding in unearthing and addressing any undetected bugs or security vulnerabilities.
3. **Rate Limiting:** Consider implementing rate limiting within the contract to prevent repeated, rapid calls to sensitive functions, which could potentially be exploited.
4. **Optimizations:** Consider implementing the suggested optimizations to improve the efficiency of the contract and reduce the risk of potential attacks.
5. **Extended Testing:** It is recommended to conduct further testing to ensure the robustness of the contract and to discover any potential edge cases that could result in unanticipated behavior as I was best able to test the oracle and rewards system with the time allotted and there may be edge cases that I did not consider.

## **Conclusion:**

The codebase has been thoroughly reviewed with several minor and medium issues discovered, but no high or critical security vulnerabilities were identified. The codebase appears to be overall well-structured and follows good programming practices. However, it is strongly recommended to address the issues identified, particularly around oracle counting and potential dilution attack vector, in order to further harden the security of the contracts. It is also recommended to implement the suggested optimizations and preventative measures, such as fuzz testing, a bug bounty program, and rate limiting. Overall, the contract's security posture is good, and the codebase is well-structured and well-written with a few minor issues that should be addressed.
